<!DOCTYPE html>
<meta charset="utf-8">
<style>
text{
	font-size:12px;
}
.mainBars rect{
  shape-rendering: auto;
  fill-opacity: 0;
  stroke-width: 0.5px;
  stroke: rgb(0, 0, 0);
  stroke-opacity: 0;
}
.subBars{
	shape-rendering:crispEdges;
}
.edges{
	stroke:none;
	fill-opacity:0.5;
}
.header{
	text-anchor:middle;
	font-size:16px;
}
line{
	stroke:grey;
}
</style>
<body>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="http://vizjs.org/viz.v1.1.0.min.js"></script>

<script src="https://d3js.org/d3-color.v1.min.js"></script>
<script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

<script>

var full_group_list_bad = [
'Graph Theory',
'High Energy Physics',
'Steganography',
'Theoretical Economics',
'Computation and Language',
'Quantum Cryptography',
'Machine Learning',
];
var dec_group_list = [
'state, gauge, theory, operator, string, basis',
'graph, vertex, general position, set, position, edge',
'topic, set, word, function, time, image',
'state, matrix, function, player, action, policy',
'graph, vertex, edge, cycle, integer, matrix',
'matrix, digraph, graph, filter, vertex, causal',
'firm, model, pixel, vendor, decoder, context',
];

//color = d3.scale.category10().domain(d3.range(20));
color = d3.scaleOrdinal(d3.schemeCategory10).domain(d3.range(20));


var data=[
['Graph Theory', 'graph, vertex, general position, set, position, edge', 30, 11], 
['Graph Theory', 'topic, set, word, function, time, image', 30, 68], 
['Graph Theory', 'graph, vertex, edge, cycle, integer, matrix', 30, 10], 
['Graph Theory', 'matrix, digraph, graph, filter, vertex, causal', 30, 8], 
['High Energy Physics', 'state, gauge, theory, operator, string, basis', 30, 28], 
['High Energy Physics', 'topic, set, word, function, time, image', 30, 68], 
['High Energy Physics', 'state, matrix, function, player, action, policy', 30, 56], 
['High Energy Physics', 'firm, model, pixel, vendor, decoder, context', 30, 29], 
['Steganography', 'topic, set, word, function, time, image', 30, 68], 
['Steganography', 'state, matrix, function, player, action, policy', 30, 56], 
['Steganography', 'firm, model, pixel, vendor, decoder, context', 30, 29], 
['Theoretical Economics', 'topic, set, word, function, time, image', 30, 68], 
['Theoretical Economics', 'state, matrix, function, player, action, policy', 30, 56], 
['Theoretical Economics', 'firm, model, pixel, vendor, decoder, context', 30, 29], 
['Computation and Language', 'topic, set, word, function, time, image', 30, 68], 
['Computation and Language', 'state, matrix, function, player, action, policy', 30, 56], 
['Computation and Language', 'firm, model, pixel, vendor, decoder, context', 30, 29], 
['Quantum Cryptography', 'state, gauge, theory, operator, string, basis', 30, 28], 
['Quantum Cryptography', 'topic, set, word, function, time, image', 30, 68], 
['Quantum Cryptography', 'state, matrix, function, player, action, policy', 30, 56], 
['Machine Learning', 'state, gauge, theory, operator, string, basis', 30, 28], 
['Machine Learning', 'topic, set, word, function, time, image', 30, 68], 
['Machine Learning', 'state, matrix, function, player, action, policy', 30, 56], 
['Machine Learning', 'firm, model, pixel, vendor, decoder, context', 30, 29],
];
//var color ={Elite:"#3366CC", Grand:"#DC3912",  Lite:"#FF9900", Medium:"#109618", Plus:"#990099", Small:"#0099C6"};
var svg = d3
	.select("body")
	.append("svg")
	.attr("width", 960)
	.attr("height", 800);

	
svg.append("text").attr("x",450).attr("y",70)
	.attr("class","header").text("arXiv Fields vs. Math Text Clustering");
	
//svg.append("text").attr("x",750).attr("y",70).attr("class","header").text("Sales");

	
var g =[svg.append("g").attr("transform","translate(350,100)")
		,svg.append("g").attr("transform","translate(650,100)")];

		
var bp=[ viz.bP()
		.data(data)
		.min(12)
		.pad(5)
		.height(600)
		.width(200)
		.barSize(35)
		//.fill(d=>color[d.primary])		
		.fill(d=>color(dec_group_list.indexOf(
		d.secondary)))
		
	,viz.bP()
		.data(data)
		.value(d=>d[3])
		.min(12)
		.pad(1)
		.height(600)
		.width(200)
		.barSize(35)
		//.fill(d=>color[d.primary])
		.fill(d=>color(dec_group_list.indexOf(d.secondary)))
		
];


//[0,1].forEach(function(i){
[0].forEach(function(i){
	g[i].call(bp[i])
	
	g[i].append("text")
		.attr("x",-50).attr("y",-8)
		.style("text-anchor","middle").text("Classified by Research Fields");
		
	g[i].append("text")
		.attr("x", 250).attr("y",-8)
		.style("text-anchor","middle").text("Clustered by Texts in MWM Sentences");
	
	g[i].append("line").attr("x1",-100).attr("x2",0);
	g[i].append("line").attr("x1",200).attr("x2",300);
	
	g[i].append("line")
		.attr("y1",610).attr("y2",610)
		.attr("x1",-100).attr("x2",0);
	g[i].append("line")
		.attr("y1",610).attr("y2",610)
		.attr("x1",200).attr("x2",300);
	
	g[i].selectAll(".mainBars")
		.on("mouseover",mouseover)
		.on("mouseout",mouseout);

	g[i].selectAll(".mainBars").append("text").attr("class","label")
		.attr("x",d=>(d.part=="primary"? -30: 30))
		.attr("y",d=>+6)
		.text(d=>d.key)
		.attr("text-anchor",d=>(d.part=="primary"? "end": "start"));
	
	g[i].selectAll(".mainBars").append("text").attr("class","perc")
		.attr("x",d=>(d.part=="primary"? -100: 80))
		.attr("y",d=>+20)
		.text(function(d){ return d3.format("0.0%")(d.percent)})
		.attr("text-anchor",d=>(d.part=="primary"? "end": "start"));
});

function mouseover(d){
	[0,1].forEach(function(i){
		bp[i].mouseover(d);
		
		g[i].selectAll(".mainBars").select(".perc")
		.text(function(d){ return d3.format("0.0%")(d.percent)});
	});
}
function mouseout(d){
	[0,1].forEach(function(i){
		bp[i].mouseout(d);
		
		g[i].selectAll(".mainBars").select(".perc")
		.text(function(d){ return d3.format("0.0%")(d.percent)});
	});
}
d3.select(self.frameElement).style("height", "800px");
</script>
</body>
</html>